#!/bin/bash

wal_img="$1"
[ -z "$wal_img" ] && exit 1

# 1. Run matugen to generate Material You colors
# This generates colors and renders templates (waybar, foot, etc.)
matugen image "$wal_img"

# 2. Apply wallpaper
if command -v swww >/dev/null 2>&1; then
    swww img "$wal_img" --transition-type any
fi

# 3. Restart waybar to apply new colors
pkill waybar 2>/dev/null
waybar &>/dev/null &
disown

# 4. SwayNC reload
swaync-client -rs 2>/dev/null